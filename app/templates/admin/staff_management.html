{% extends 'base.html' %}


{% block css_style %} 

    <link rel="stylesheet" href="{{url_for('static',filename='css/flex.css')}}"> 
    <link rel="stylesheet" href="{{url_for('static',filename='css/grid.css')}}"> 
    <link rel="stylesheet" href="{{url_for('static',filename='css/table.css')}}"> 
    <link rel="stylesheet" href="{{url_for('static',filename='css/form.css')}}"> 
    <link rel="stylesheet" href="{{url_for('static',filename='css/modal.css')}}"> 

{% endblock %}
{% block nav_staff %}active{% endblock %}
{% block content %}
<a href="{{url_for('staff.create_staff')}}" class="btn" >Add New</a> <br><br>
<form action="{{url_for('utils.excel_upload',entity = "staff")}}" method="post" enctype = "multipart/form-data" >
    <input type = "file" name = "file"  />
    <input type="submit" name="upload_excel" value="IMPORT">
    <br><br>
</form>
<form action="" method="get">
    <input type="text" name="search" placeholder="Search Field" required>
    <button type="submit" class="button primary">Search</button>
</form>
<div class="table-container maxheight-800 scrollable">
    <table >
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Role</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for staff in staffs %}
            <tr>
                <form method="POST" action="{{ url_for('staff.edit_staff', id=staff.id) }}" style="display: inline-block;">
                <td>
                    <span><a href="{{url_for('staff.get_staff',id = staff.id)}}">{{ staff.id}}</a></span>
                    <input type="text" style="display: none;" name="staff_id" id="staff_id" value="{{staff.id}}" required>
                </td>      
                <td>
                    <span><a href="{{url_for('staff.get_staff',id = staff.id)}}">{{ staff.Name}}</a></span>
                    <input type="text" style="display: none;" name="staff_name" id="staff_name" value="{{staff.Name}}" required>
                </td>      
                <td>
                    <span>{{ staff.Email}}</span>
                    <input type="email" style="display: none;" name="staff_email" id="staff_name" value="{{staff.Email}}" required>
    
                </td>      
    
                <td>
                    <!-- <span>{{ staff.Role}}</span> -->
                    
                    <input type="radio" name="role" id="admin" value="admin" {% if staff.Role == 'admin' %} checked {% endif %} disabled><label for="admin">admin</label>
                    <input type="radio" name="role" id="staff" value="staff" {% if staff.Role == 'staff' %} checked {% endif %} disabled><label for="staff">staff</label>
                </td>    
                
                <td>
                    <button type="button" class="button info" id="edit" href="javascript:;"><i class='bx bx-edit'></i></button>
                    <button type="submit" class="button info" id="update" style="display: none;"><i class='bx bx-check'></i></button>
                    <button type="button" class="button gray" id="cancel" href="javascript:;" style="display: none;"><i class='bx bx-x'></i></button>
                    
                </form>
                
                    <form method="POST" action="{{ url_for('staff.delete_staff', id=staff.id) }}" style="display: inline-block;">
                        <button id="delete" type="submit" class="button error" onclick="return confirm('Are you sure you want to delete this item?')"><i class='bx bx-trash-alt'></i></button>
                    </form>
                </td>    
               
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>



<script type="text/javascript">
    var btnEdits = document.querySelectorAll('#edit');
    var btnCancels = document.querySelectorAll('#cancel');
    btnEdits.forEach((btnEdit)=>{
        btnEdit.addEventListener('click',editable);
    })
    
    btnCancels.forEach((btnCancel)=>{
        btnCancel.addEventListener('click',editable)
    })

    function editable(event) {
        var row = event.target.closest('tr');
            var inputElements = row.querySelectorAll('input:not([type=radio])');
            var spanElements = row.querySelectorAll('span');
            var radioElements = row.querySelectorAll('input[type="radio"]');
            inputElements.forEach((inputElement) => {
                inputElement.style.display = (inputElement.style.display === 'none') ? 'inline-block' : 'none';
            });

            spanElements.forEach((spanElement) => {
                spanElement.style.display = (spanElement.style.display === 'none') ? 'inline-block' : 'none';
            });

            radioElements.forEach((radioElement) => {
                radioElement.disabled = (radioElement.disabled === true) ? false : true;
            });
             // Toggle the display of the edit, update, and cancel links
            row.querySelector('#edit').style.display = (row.querySelector('#edit').style.display === 'none') ? 'inline-block' : 'none';
            row.querySelector('#update').style.display = (row.querySelector('#update').style.display === 'none') ? 'inline-block' : 'none';
            row.querySelector('#cancel').style.display = (row.querySelector('#cancel').style.display === 'none') ? 'inline-block' : 'none';
            row.querySelector('#delete').style.display = (row.querySelector('#delete').style.display === 'none') ? 'inline-block' : 'none';
    }
</script>

{% endblock %}