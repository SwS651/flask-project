{% extends 'base.html' %}
{% block nav_category %}active{% endblock %}
{% block content %}
<h2>Category</h2>
<div class="">
  <form action="{{url_for('utils.excel_upload',entity = "category")}}" method="post" enctype = "multipart/form-data" >
    <input type = "file" name = "file"  />
    <input type="submit" name="upload_excel" value="IMPORT">
    <br><br>
</form>
  <form method="POST" action="{{ url_for('category.create_category') }}">
    <!-- Add any necessary form fields and styling as needed -->
    <label for="category_name">Category:</label>
    <input type="text" id="category_name" name="category_name" required> <br>

    <button type="submit">Add Category</button>
  </form>
</div>
<br>
<div class="">

  <table class="table table-striped" border="1" style="width: 40%;">
    <colgroup>
      <col span="1" style="width: auto;">
      <col span="1" style="width: auto ;">
      <col span="1" style="width: 30%;">
    </colgroup>
    <thead>
      <tr>
        <th>ID</th>
        <th>Category</th>
        <!-- Add other header columns as needed -->
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for category in categories %}
      <tr>
        <form method="POST" action="{{ url_for('category.edit_category',category_name = category.category_name) }}" style="display: inline-block;">
        <td>
          <span>{{ category.id }}</span>
        </td>
        <td>
          <span>{{ category.category_name }}</span>
          <input type="text" style="display: none;" name="category_name" id="category_name" value="{{ category.category_name }}" required>
          

        </td>

        <!-- Add other data columns as needed -->
        <td>
            <button type="button" id="edit" href="javascript:;">Edit</button>
            
            <button type="submit" id="update" style="display: none;">Update</button>
            <button type="button" id="cancel" href="javascript:;" style="display: none;">Cancel</button>
        </form>

          <form method="POST" action="{{ url_for('category.delete_category', category_id=category.id) }}"
            style="display: inline-block;">
            <button type="submit" id="delete" onclick="return confirm('Are you sure you want to delete this item?')">Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

</div>


<script type="text/javascript">
  var btnEdits = document.querySelectorAll('#edit');
  var btnCancels = document.querySelectorAll('#cancel');
  btnEdits.forEach((btnEdit)=>{
      btnEdit.addEventListener('click',editable);
  })
  
  btnCancels.forEach((btnCancel)=>{
      btnCancel.addEventListener('click',editable)
  })

  function editable(event) {
      var row = event.target.closest('tr');
          var inputElements = row.querySelectorAll('input:not([type=radio])');
          var spanElements = row.querySelectorAll('span');
          var radioElements = row.querySelectorAll('input[type="radio"]');
          inputElements.forEach((inputElement) => {
              inputElement.style.display = (inputElement.style.display === 'none') ? 'inline-block' : 'none';
          });

          spanElements.forEach((spanElement) => {
              spanElement.style.display = (spanElement.style.display === 'none') ? 'inline-block' : 'none';
          });

          radioElements.forEach((radioElement) => {
              radioElement.disabled = (radioElement.disabled === true) ? false : true;
          });
           // Toggle the display of the edit, update, and cancel links
          row.querySelector('#edit').style.display = (row.querySelector('#edit').style.display === 'none') ? 'inline-block' : 'none';
          row.querySelector('#update').style.display = (row.querySelector('#update').style.display === 'none') ? 'inline-block' : 'none';
          row.querySelector('#cancel').style.display = (row.querySelector('#cancel').style.display === 'none') ? 'inline-block' : 'none';
          row.querySelector('#delete').style.display = (row.querySelector('#delete').style.display === 'none') ? 'inline-block' : 'none';
  }
</script>

{% endblock %}